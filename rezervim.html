<section class="page page-rezervim" id="page-rezervim">

  <div class="page-header">
    <span class="page-eyebrow" data-i18n="rezEyebrow">Rezervoni TavolinÃ«n Tuaj</span>
    <h2 class="page-title" data-i18n="rezTitle">BÃ«ni Rezervimin</h2>
    <div class="page-divider"></div>
  </div>

  <!-- LAJMÃ‹RIM DISPONUESHMÃ‹RIA (shfaqet nga JS) -->
  <div id="avail-notice-client" style="display:none; max-width:800px; margin:0 auto 24px; padding:0 24px;">
    <div class="avail-notice-client-box" id="avail-notice-client-inner"></div>
  </div>

  <div class="rez-layout">
    <div class="rez-form-col">

      <div class="info-banner" role="note">
        <span class="info-icon">â„¹ï¸</span>
        <span data-i18n="rezInfo">Pas rezervimit do tÃ« merrni njÃ« <strong>ID unik</strong> dhe <strong>PIN 6-shifror</strong> sigurie me tÃ« cilin mund ta modifikoni rezervimin tuaj.</span>
      </div>

      <form class="rez-form" id="rez-form" novalidate autocomplete="off">

        <fieldset class="form-section">
          <legend class="form-section-title" data-i18n="rezPersonal">TÃ« DhÃ«nat Personale</legend>
          <div class="form-row two-col">
            <div class="form-group">
              <label class="form-label" for="f-emri" data-i18n="labelEmri">Emri *</label>
              <input type="text" id="f-emri" name="emri" class="form-control" autocomplete="given-name" required />
            </div>
            <div class="form-group">
              <label class="form-label" for="f-mbiemri" data-i18n="labelMbiemri">Mbiemri *</label>
              <input type="text" id="f-mbiemri" name="mbiemri" class="form-control" autocomplete="family-name" required />
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="f-tel" data-i18n="labelTel">Telefon / WhatsApp *</label>
            <input type="tel" id="f-tel" name="tel" class="form-control" placeholder="06X XX XX XXX" required />
          </div>
        </fieldset>

        <fieldset class="form-section">
          <legend class="form-section-title" data-i18n="rezDetails">Detajet e Rezervimit</legend>

          <div class="form-row rez-details-row">
            <div class="form-group">
              <label class="form-label" for="f-data" data-i18n="labelData">Data *</label>
              <input type="date" id="f-data" name="data" class="form-control" required />
            </div>
            <!-- ORA â€” Radial Clock Picker -->
            <div class="form-group">
              <label class="form-label" data-i18n="labelOra">Ora *</label>
              <input type="hidden" id="f-ora" name="ora" required />

              <!-- Trigger button -->
              <div class="rclock-trigger" id="rclock-trigger" onclick="APP.openRadialClock()">
                <span class="rclock-trigger-icon">âš“</span>
                <span class="rclock-trigger-text" id="rclock-trigger-text">â€” Zgjidhni orÃ«n â€”</span>
                <span class="rclock-trigger-arrow">â–¾</span>
              </div>

              <!-- Clock Modal Overlay -->
              <div class="rclock-overlay" id="rclock-overlay" style="display:none" onclick="APP.closeRadialClock(event)">
                <div class="rclock-modal" onclick="event.stopPropagation()">

                  <!-- Header with digital display -->
                  <div class="rclock-header">
                    <div class="rclock-display">
                      <span class="rclock-display-hour" id="rclock-disp-hour">--</span>
                      <span class="rclock-display-sep">:</span>
                      <span class="rclock-display-min" id="rclock-disp-min">--</span>
                    </div>
                    <div class="rclock-mode-btns">
                      <button type="button" class="rclock-mode-btn active" id="rclock-btn-hour" onclick="APP.rclockSetMode('hour')">Ora</button>
                      <button type="button" class="rclock-mode-btn" id="rclock-btn-min" onclick="APP.rclockSetMode('min')">Min</button>
                    </div>
                  </div>

                  <!-- SVG Clock Face -->
                  <div class="rclock-face-wrap">
                    <svg class="rclock-face" id="rclock-svg" viewBox="0 0 280 280"
                         xmlns="http://www.w3.org/2000/svg">
                      <!-- Outer ring -->
                      <circle cx="140" cy="140" r="132" fill="none" stroke="rgba(201,168,76,0.18)" stroke-width="1.5"/>
                      <!-- Inner ring -->
                      <circle cx="140" cy="140" r="100" fill="none" stroke="rgba(201,168,76,0.08)" stroke-width="1"/>
                      <!-- Center dot -->
                      <circle cx="140" cy="140" r="5" fill="#C9A84C" id="rclock-center"/>
                      <!-- Hand -->
                      <line id="rclock-hand" x1="140" y1="140" x2="140" y2="20"
                            stroke="#C9A84C" stroke-width="2.5" stroke-linecap="round"
                            style="transform-origin:140px 140px; transform:rotate(0deg); transition:transform 0.25s cubic-bezier(0.34,1.56,0.64,1)"/>
                      <!-- Hand tip circle -->
                      <circle id="rclock-hand-tip" cx="140" cy="20" r="14"
                              fill="rgba(201,168,76,0.25)" stroke="#C9A84C" stroke-width="1.5"
                              style="transform-origin:140px 140px; transform:rotate(0deg); transition:transform 0.25s cubic-bezier(0.34,1.56,0.64,1)"/>
                      <!-- Number labels rendered by JS -->
                      <g id="rclock-numbers"></g>
                    </svg>
                  </div>

                  <!-- Hint text -->
                  <div class="rclock-hint" id="rclock-hint">Klikoni orÃ«n</div>

                  <!-- Action buttons -->
                  <div class="rclock-actions">
                    <button type="button" class="rclock-cancel" onclick="APP.closeRadialClock()">Anulo</button>
                    <button type="button" class="rclock-confirm" id="rclock-confirm-btn" onclick="APP.confirmRadialClock()" disabled>âš“ Konfirmo</button>
                  </div>

                </div>
              </div>
            </div>
          </div>

          <!-- PERSONA -->
          <div class="form-row rez-details-row">
            <div class="form-group">
              <label class="form-label" for="f-persona" data-i18n="labelPersona">Numri i Personave *</label>
              <select id="f-persona" name="persona" class="form-control" required onchange="APP.handlePersonaChange(this.value)">
                <option value="" data-i18n="selectPersona">â€” Zgjidhni â€”</option>
                <option value="1">1 person</option>
                <option value="2">2 persona</option>
                <option value="3">3 persona</option>
                <option value="4">4 persona</option>
                <option value="5">5 persona</option>
                <option value="6">6 persona</option>
                <option value="6+">6+ persona (Specifikoni)</option>
              </select>
            </div>
          </div>

          <!-- KUTIA PÃ‹R 6+ -->
          <div id="custom-guests-group" style="display:none" class="custom-guests-box">
            <div class="form-row two-col">
              <div class="form-group">
                <label class="form-label" for="f-persona-custom">Sa persona saktÃ«sisht? *</label>
                <input type="number" id="f-persona-custom" name="persona_custom"
                  class="form-control" min="7" max="200" placeholder="p.sh. 15" />
              </div>
              <div class="form-group">
                <label class="form-label">Keni nevojÃ« pÃ«r bashkim tavolinash?</label>
                <div class="table-join-toggle">
                  <label class="toggle-switch">
                    <input type="checkbox" id="f-table-join" name="table_join">
                    <span class="toggle-slider"></span>
                  </label>
                  <span class="toggle-label" id="table-join-label">Jo</span>
                </div>
              </div>
            </div>
            <div id="table-join-note" style="display:none" class="table-join-info">
              â„¹ï¸ Do tÃ« kontaktoheni nga stafi pÃ«r konfirmimin e bashkimit tÃ« tavolinave.
            </div>
          </div>

          <!-- VENDI -->
          <div class="form-group">
            <label class="form-label" for="f-vendi" data-i18n="labelVendi">Ku dÃ«shironi tÃ« uleni? *</label>
            <select id="f-vendi" name="vendi" class="form-control" required>
              <option value="">â€” Zgjidhni vendin â€”</option>
              <option value="brenda">ğŸ  Brenda Restorantit</option>
              <option value="jashte">ğŸŒ… JashtÃ« (TarracÃ«/Oborr)</option>
              <option value="pa-preference">ğŸ“ Pa PreferencÃ«</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label" for="f-mesazh" data-i18n="labelMesazh">Mesazh (opsional)</label>
            <textarea id="f-mesazh" name="mesazh" class="form-control" rows="3"
              placeholder="KÃ«rkesa speciale, alergji, ditÃ«lindje etj..."></textarea>
          </div>
        </fieldset>

        <!-- Para-porosi nga menu -->
        <div id="rez-preorder-summary" hidden class="preorder-summary-box">
          <h4 data-i18n="rezPreorderTitle">ğŸ›’ Parapagimi Juaj i ParapÃ«lqyer</h4>
          <div id="rez-preorder-items"></div>
          <div class="preorder-summary-total">
            <span data-i18n="rezEstimated">Estimuar:</span>
            <strong id="rez-preorder-total-val"></strong>
          </div>
          <p class="preorder-disclaimer" data-i18n="rezDisclaimer">âš ï¸ Kjo nuk Ã«shtÃ« fatura finale.</p>
        </div>

        <div class="form-submit">
          <button type="submit" class="btn btn-primary btn-lg btn-full" id="rez-submit-btn">
            <span class="btn-text" data-i18n="rezSubmit">âš“ Konfirmo Rezervimin</span>
            <span class="btn-spinner" hidden><span class="spinner spinner-sm"></span></span>
          </button>
        </div>
      </form>
    </div>

    <div class="rez-info-col">
      <div class="mod-card">
        <h3 class="mod-title" data-i18n="modTitle">Keni njÃ« rezervim?</h3>
        <p class="mod-desc" data-i18n="modDesc">Vendosni kodin dhe PIN-in pÃ«r tÃ« parÃ« ose modifikuar detajet.</p>
        <div class="form-group">
          <label class="form-label" for="mod-id" data-i18n="modIdLabel">ID Rezervimit</label>
          <input type="text" id="mod-id" class="form-control" placeholder="AH-XXXX" style="text-transform:uppercase" />
        </div>
        <div class="form-group">
          <label class="form-label" for="mod-pin" data-i18n="modPinLabel">PIN SigurisÃ« (6 shifra)</label>
          <input type="text" id="mod-pin" class="form-control" maxlength="6" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" inputmode="numeric" />
        </div>
        <button class="btn btn-outline btn-full" id="mod-lookup-btn" onclick="APP.lookupBooking()">
          <span data-i18n="modLookup">ğŸ” Gjej Rezervimin</span>
        </button>
        <div id="mod-result" hidden style="margin-top:16px"></div>
      </div>

      <div class="contact-quick-card">
        <div class="contact-quick-item"><span>ğŸ“</span><a href="tel:+355676645476">+355 67 664 5476</a></div>
        <div class="contact-quick-item"><span>ğŸ“</span><span data-i18n="contactAddr">Bulevardet e Detit, ShqipÃ«ri</span></div>
        <div class="contact-quick-item"><span>ğŸ•</span><span data-i18n="contactHours">12:00 â€“ 23:00, Ã§do ditÃ«</span></div>
      </div>
    </div>
  </div>
</section>
